#summary Adding a challenge password to a PKCS#10 certification request
#labels Manual

{{{
String signatureAlgorithm = "SHA1withRSA";
X500Principal subject = new X500Principal("CN=alpha.jscep.org");
PublicKey key = ...;

DERObjectIdentifier attrType = PKCSObjectIdentifiers.pkcs_9_at_challengePassword;
ASN1Set attrValues = new DERSet(new DERPrintableString("challenge"));
DEREncodable password = new Attribute(attrType, attrValues);
ASN1Set attributes = new DERSet(password);

PrivateKey signingKey = ...;

PKCS10CertificationRequest csr = new PKCS10CertificationRequest(signatureAlgorithm, subject, key, attributes, signingKey);
}}} 